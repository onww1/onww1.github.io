---
layout: article
title: Requestsë¡œ í¬ë¡¤ë§í•˜ê¸°
permalink: /programming/py-crawling-2
key: TIL-programming-py-crawling-2
tags: TIL í”„ë¡œê·¸ë˜ë° Python Crawling

header:
  theme: dark
  background: 'linear-gradient(135deg, rgba(0, 189, 128, .7), rgba(0, 128, 255, .8))'

article_header:
  type: overlay
  theme: dark
  background_color: '#203028'
  background_image:
    gradient: 'linear-gradient(135deg, rgba(0, 189, 128, .25), rgba(0, 128, 255, .3))'
    src: /assets/images/post/background/background44.jpg

aside:
  toc: true
sidebar:
  nav: programming
license: false
show_author_profile: true
---

## Pythonì—ì„œ Requestsë¡œ ë°±ì¤€ í¬ë¡¤ë§í•˜ê¸°
<!--more-->

ì•ˆë…•í•˜ì„¸ìš”. **Mochalatte** ì…ë‹ˆë‹¤.

ì§€ë‚œ ê¸€ì—ì„œ **Python**ì— ìˆëŠ” `Selenium`ê³¼ `BeautifulSoup4`ë¥¼ ì´ìš©í•˜ì—¬ [ë°±ì¤€ ì˜¨ë¼ì¸ ì €ì§€](https://boj.kr/)ë¥¼ í¬ë¡¤ë§í•˜ëŠ” ê²ƒì— ëŒ€í•´ì„œ ë‹¤ë£¨ì—ˆìŠµë‹ˆë‹¤. ì‚¬ì‹¤ `selenium`ì€ ë¸Œë¼ìš°ì €ë¥¼ ì´ìš©í•˜ì—¬ í¬ë¡¤ë§ì„ í•˜ê¸° ë•Œë¬¸ì— **ë™ì  í˜ì´ì§€**ì— ëŒ€í•œ í¬ë¡¤ë§ë„ ê°€ëŠ¥í•˜ë‹¤ëŠ” ì¥ì ì´ ìˆì§€ë§Œ ëŠë¦¬ë‹¤ëŠ” ë‹¨ì ë„ ìˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ë™ì  í˜ì´ì§€ê°€ ì•„ë‹Œ **ì •ì  í˜ì´ì§€**ì¸ ê²½ìš°ì—ëŠ” êµ³ì´ `selenium`ì„ ì“¸ í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤. ê·¸ì € **API**ë¥¼ í†µí•˜ì—¬ **request**ë¥¼ ë³´ë‚´ê³ , ê·¸ì— ëŒ€í•œ **response**ë¡œ ë°›ì€ html íŒŒì¼ì„ `BeautifulSoup`ë¡œ íŒŒì‹±í•˜ë©´ ë©ë‹ˆë‹¤. ê·¸ë˜ì„œ ì˜¤ëŠ˜ì€ ì´ì— ëŒ€í•´ì„œ ê°„ë‹¨íˆ ë‹¤ë£¨ì–´ ë³´ë ¤ê³  í•©ë‹ˆë‹¤.

`BeautifulSoup`ë¥¼ ë‹¤ë£¨ëŠ” ê²ƒì€ ë™ì¼í•˜ê¸° ë•Œë¬¸ì— `Requests`ë¥¼ ì´ìš©í•˜ëŠ” ê²ƒì„ ì¤‘ì ì ìœ¼ë¡œ ë‹¤ë¤„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

---

### í¬ë¡¤ë§ ì¤€ë¹„í•˜ê¸°

`Requests`ë¡œ í¬ë¡¤ë§ì„ í•˜ê¸° ìœ„í•´ì„œ í•„ìš”í•œ ê²ƒë“¤ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

```text
ì¤€ë¹„ë¬¼ : bs4, requests
```

- ë§Œì•½ `bs4`ë‚˜ `requests`ê°€ ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•Šìœ¼ì‹œë‹¤ë©´, **í„°ë¯¸ë„**(ë˜ëŠ” **cmd**)ì—ì„œ ë‹¤ìŒê³¼ ê°™ì€ ì»¤ë§¨ë“œë¥¼ ì‹¤í–‰í•˜ì—¬ ì„¤ì¹˜í•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤.
  ```bash
  pip install bs4
  pip install requests

  # Linux, Mac ë“±ì—ì„œ Python3ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°
  pip3 install bs4
  pip3 install requests
  ```

---

### í¬ë¡¤ë§ì„ í•˜ê¸° ì „ì—

í¬ë¡¤ë§ì„ ì‹œì‘í•˜ê¸°ì— ì•ì„œ `ì¿ í‚¤(Cookie)`ì™€ `ì„¸ì…˜(Session)`ì— ëŒ€í•´ ì•Œì•„ì•¼ í•  í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤. ì´ ë‘ ê°€ì§€ê°€ í•„ìš”í•œ ê·¼ë³¸ì ì¸ ì´ìœ ëŠ” **ê° ìš”ì²­ì— ëŒ€í•˜ì—¬ ì‚¬ìš©ìë¥¼ êµ¬ë³„**í•˜ê¸° ìœ„í•¨ì…ë‹ˆë‹¤. ëŒ€ë¶€ë¶„ì˜ ì›¹ì€ **HTTP**ë¼ëŠ” í”„ë¡œí† ì½œì„ í†µí•´ì„œ ë™ì‘í•˜ê²Œ ë©ë‹ˆë‹¤. ê·¸ëŸ°ë° **HTTP**ì˜ íŠ¹ì§•ì€ ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ê°€ ì—°ê²°ì„ ì§€ì†ì ìœ¼ë¡œ ìœ ì§€í•˜ì§€ ì•Šê³ , í´ë¼ì´ì–¸íŠ¸ê°€ `ìš”ì²­(Request)`ë¥¼ ë³´ë‚¼ ë•Œë§ˆë‹¤ ì—°ê²°ì„ í•˜ì—¬ `ì‘ë‹µ(Response)`ì„ í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. ê·¸ë˜ì„œ ë§¤ë²ˆ ìš”ì²­ì„ ë°›ì„ ë•Œë§ˆë‹¤ ì´ ìš”ì²­ì´ ì´ì „ì— ìš”ì²­ì„ í–ˆë˜ ì‚¬ìš©ìì™€ ê°™ì€ì§€ë¥¼ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤. ì´ëŸ´ ë•Œ í•„ìš”í•œ ê²ƒì´ `ì¿ í‚¤(Cookie)`ì™€ `ì„¸ì…˜(Session)`ì…ë‹ˆë‹¤.

`ì¿ í‚¤`ëŠ” ì›¹ ì‚¬ì´íŠ¸ë¥¼ ë°©ë¬¸í–ˆì„ ë•Œ, ê·¸ ì‚¬ì´íŠ¸ë¡œë¶€í„° ë¸Œë¼ìš°ì €ì— í• ë‹¹ë˜ëŠ” ì‘ì€ `íŒŒì¼`ì´ê³ , `Key - Value` í˜•ì‹ìœ¼ë¡œ ë¡œì»¬ ë¸Œë¼ìš°ì €ì— ì €ì¥ë©ë‹ˆë‹¤. ì´ë ‡ê²Œ ì €ì¥ëœ ì¿ í‚¤ì˜ ì •ë³´ë¥¼ ì½ì–´ì„œ HTTP ìš”ì²­ì— ëŒ€í•´ ë¸Œë¼ìš°ì €ë¥¼ ì‹ë³„í•˜ê²Œ ë©ë‹ˆë‹¤.

ê·¸ëŸ°ë° ì¿ í‚¤ê°€ ë¡œì»¬ ë¸Œë¼ìš°ì €ì— ì €ì¥ì´ ë˜ê¸° ë•Œë¬¸ì— ì‚¬ìš©ìê°€ ì•…ì˜ì ìœ¼ë¡œ ì¿ í‚¤ë¥¼ ë³€ì¡°í•´ì„œ ë¹„ì •ìƒì ì¸ ì¿ í‚¤ë¡œ ì„œë²„ì— ìš”ì²­ì„ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ë‹¨ìˆœíˆ ì´ ì‚¬ìš©ìì— ëŒ€í•´ì„œ **ë¡œê·¸ì¸ëœ ìœ ì €**ë¼ëŠ” ì •ë³´ë¥¼ ì¿ í‚¤ë§Œìœ¼ë¡œ ì‹ ë¢°í•˜ê²Œ ëœë‹¤ë©´ ë‹¤ë¥¸ ì‚¬ëŒìœ¼ë¡œ ìœ„ì¥í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.

ì´ëŸ¬í•œ ë¬¸ì œì ìœ¼ë¡œ ì¸í•˜ì—¬ ì„œë²„ì—ì„œ í´ë¼ì´ì–¸íŠ¸ë¥¼ ì‹ë³„í•˜ëŠ” `ì„¸ì…˜`ì„ ì£¼ë¡œ ì´ìš©í•©ë‹ˆë‹¤.

`ì„¸ì…˜`ì€ ë¸Œë¼ìš°ì €ê°€ ì„œë²„ì— ìš”ì²­ì„ í•œ ê²½ìš°, ì„œë²„ì—ì„œ í•´ë‹¹ ì„¸ì…˜ ì •ë³´ë¥¼ íŒŒì¼ì´ë‚˜ DBì— ì €ì¥í•˜ê³ , í´ë¼ì´ì–¸íŠ¸ì—ê²ŒëŠ” `session-id`ë¼ëŠ” ì„ì˜ì˜ ê¸´ ë¬¸ìì—´ì„ ì£¼ê²Œ ë©ë‹ˆë‹¤. ì´ë•Œ ì‚¬ìš©ë˜ëŠ” ì¿ í‚¤ëŠ” ì„œë²„ê°„ì˜ ì—°ê²°ì´ ëŠì–´ì§„ ê²½ìš° ì‚­ì œë˜ëŠ” **ë©”ëª¨ë¦¬ ì¿ í‚¤**ë¥¼ ì´ìš©í•˜ê²Œ ë©ë‹ˆë‹¤.

> ìœ„ ë‚´ìš©ì€ https://beomi.github.io/2017/01/20/HowToMakeWebCrawler-With-Login/ ë¥¼ ì°¸ê³ í•˜ì˜€ìŠµë‹ˆë‹¤.

---

### ë°±ì¤€ ë¬¸ì œ ë¦¬ìŠ¤íŠ¸ í¬ë¡¤ë§í•˜ê¸°

ì´ì œ `requests`ì— ìˆëŠ” `Session`ì„ ì´ìš©í•˜ì—¬ ì„¸ì…˜ì„ ë§Œë“¤ê³ , `selenium`ìœ¼ë¡œë„ í•´ë³´ì•˜ë˜ ë°±ì¤€ [ì „ì²´ ë¬¸ì œ](https://www.acmicpc.net/problemset) íƒ­ í¬ë¡¤ë§ì„ í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. ë¨¼ì € í•„ìš”í•œ ëª¨ë“ˆë“¤ì„ importí•˜ê³ , Sessionì„ ë§Œë“­ë‹ˆë‹¤.

```python
import requests
from bs4 import BeautifulSoup as bs

with requests.Session() as s:
    # Code
```

&nbsp;
ê·¸ëŸ° ë‹¤ìŒ with êµ¬ë¬¸ ì•ˆì—ì„œ Sessionì˜ `get` í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ì „ì²´ ë¬¸ì œ ì‚¬ì´íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤. ê·¸ ë¦¬í„´ë°›ì€ ê°ì²´ì˜ `text` attributeê°€ htmlì¸ë°, ê·¸ htmlì„ `BeautifulSoup`ì—ê²Œ ë„˜ê²¨ì£¼ì–´ íŒŒì‹±í•©ë‹ˆë‹¤. ì´í›„ ì´ì „ì— í–ˆë˜ ê²ƒê³¼ ê°™ì´ **ë¬¸ì œ ë²ˆí˜¸**ì™€ **ì œëª©**ì— ëŒ€í•œ `CSS Selector`ë¥¼ `BeautifulSoup`ì—ê²Œ ë„˜ê²¨ì£¼ì–´ ë°ì´í„°ë“¤ì„ ê°€ì ¸ì˜¨ ë’¤ ì¶œë ¥í•©ë‹ˆë‹¤. ì´ì— ëŒ€í•œ ì „ì²´ ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

```python
#-*- coding:utf-8 -*-

import requests
from bs4 import BeautifulSoup as bs

with requests.Session() as s:
  page = s.get('https://www.acmicpc.net/problemset')
  soup = bs(page.text, 'html.parser')

  # ë¬¸ì œ ë²ˆí˜¸ì™€ ì œëª©ì— í•´ë‹¹ë˜ëŠ” íƒœê·¸ì˜ ì •ë³´ë¥¼ ì£¼ê³  ë°ì´í„°ë¥¼ ë°›ì•„ì˜µë‹ˆë‹¤.
  problem_number = soup.select('#problemset > tbody > tr > td:nth-of-type(1)')
  problem_title = soup.select('#problemset > tbody > tr > td:nth-of-type(2)')

  # ìˆœì°¨ì ìœ¼ë¡œ ì¶œë ¥í•©ë‹ˆë‹¤.
  for index in range(len(problem_number)):
    print(problem_number[index].text, problem_title[index].text)
```

&nbsp;
ìœ„ ì½”ë“œì˜ ê²°ê³¼ëŠ” `selenium`ìœ¼ë¡œ êµ¬í˜„í•œ í¬ë¡¤ëŸ¬ì™€ ê°™ìŠµë‹ˆë‹¤.

---

### ë¡œê·¸ì¸í•´ì„œ ì•Œê³ ë¦¬ì¦˜ ë¶„ë¥˜ ê°€ì ¸ì˜¤ê¸°

`requests`ë¥¼ ì´ìš©í•˜ì—¬ ë¡œê·¸ì¸í•˜ëŠ” ê²ƒì€ í•´ë‹¹ ì‚¬ì´íŠ¸ì˜ **API**ì— ì§ì ‘ ìš”ì²­ì„ ë³´ë‚´ì„œ í•˜ê²Œ ë©ë‹ˆë‹¤. ì´ì— í™•ì¸ì„ ìœ„í•´ `chrome ê°œë°œì ë„êµ¬`ë¥¼ ì´ìš©í•˜ì—¬ **login form** íƒœê·¸ë¥¼ í™•ì¸í•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

![login_form_tag](/assets/images/post/TIL/programming/login_form_tag.png)

&nbsp;
ìœ„ ì‚¬ì§„ì„ ë³´ë©´ form íƒœê·¸ì˜ `action` attributeê°€ `/signin`ì´ë¼ê³  ë˜ì–´ìˆìŠµë‹ˆë‹¤. ì´ê²ƒì€ ë¡œê·¸ì¸ì„ í•  ë•Œ, `/signin`ì´ë¼ëŠ” **API**ë¥¼ ì‚¬ìš©í•˜ê³ , ì˜†ì— `method` attributeê°€ `post`ë¡œ ë˜ì–´ ìˆìœ¼ë¯€ë¡œ í•´ë‹¹ **API**ì— `post` methodë¡œ ìš”ì²­ì„ í•´ì•¼ í•œë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.

ì´ì œ form íƒœê·¸ ë‚´ë¶€ì— ìˆëŠ” `input` íƒœê·¸ë“¤ì— í•„ìš”í•œ ê°’ë“¤ì„ ì±„ì›Œ ë„£ê³  ìš”ì²­ì„ ë³´ë‚´ì•¼ í•©ë‹ˆë‹¤. í•„ìš”í•œ ì •ë³´ë“¤ì€ í•´ë‹¹ `input` íƒœê·¸ì˜ `name` attributeë¥¼ `key`ë¡œ í•˜ëŠ” **dictionary**ë¥¼ ë§Œë“¤ì–´ì„œ ì „ë‹¬í•´ì£¼ë©´ ë©ë‹ˆë‹¤. ì¦‰, ë‹¤ìŒê³¼ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì§„í–‰í•˜ë©´ ë©ë‹ˆë‹¤.

```python
LOGIN_INFO = {
  'login_user_id' : 'user_id',
  'login_password' : 'user_pw'
}

with request.Session() as s:
  s.post('search_url', data=LOGIN_INFO)
```

&nbsp;
ìœ„ì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ `selenium`ìœ¼ë¡œ í–ˆë˜ ê²ƒì²˜ëŸ¼ `bojxxxx.yyy`ì˜ í˜•íƒœë¡œ ì¡´ì¬í•˜ëŠ” íŒŒì¼ë“¤ì˜ ì´ë¦„ì„ ë„˜ê²¨ì£¼ì–´ íŒŒì¼ì— ì“°ì—¬ìˆëŠ” ë²ˆí˜¸ì— í•´ë‹¹í•˜ëŠ” ë¬¸ì œì— ì ‘ê·¼í•˜ì—¬ **ì œëª©**ê³¼ **ì•Œê³ ë¦¬ì¦˜ ë¶„ë¥˜**ë¥¼ ë½‘ì•„ì˜¤ë„ë¡ ì½”ë“œë¥¼ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤. ì´ì— ëŒ€í•œ ì½”ë“œëŠ” **Github**ì— ì˜¬ë ¤ ë‘ì—ˆìŠµë‹ˆë‹¤.

[Source](https://github.com/onww1/TIL/blob/master/Python/Crawling/request_crawling.py){:.button.button--outline-success.button--pill}{:target="_blank"}


`selenium`ìœ¼ë¡œ ì‘ì„±í•œ ì½”ë“œì™€ `requests`ë¡œ ì‘ì„±í•œ ì½”ë“œë¥¼ ë˜‘ê°™ì€ ì¸í’‹ì— ëŒ€í•˜ì—¬ ì‹¤í–‰ì„ í•´ë³´ë©´ í™•ì‹¤íˆ ì†ë„ì—ì„œ ì°¨ì´ê°€ ìˆë‹¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

---

ì§€ê¸ˆê¹Œì§€ **Requests**ê³¼ **BeautifulSoup4**ë¥¼ ì´ìš©í•˜ì—¬ í¬ë¡¤ë§ì„ í•˜ëŠ” ê²ƒì— ëŒ€í•´ì„œ ë‹¤ë£¨ì—ˆê³ , ì‹¤ì œë¡œ ì œê°€ ì–´ë–»ê²Œ ì‚¬ìš©í–ˆëŠ”ì§€ë„ ë‹¤ë£¨ì—ˆìŠµë‹ˆë‹¤.

í˜¹ì‹œë¼ë„ ë¶€ì¡±í•œ ë¶€ë¶„ì´ ë³´ì´ì‹œë©´ ì–¸ì œë“ ì§€ **í”¼ë“œë°±**ì„ í•´ì£¼ì„¸ìš”!

ê°ì‚¬í•©ë‹ˆë‹¤. ğŸ™‡ğŸ»â€

---

